\documentclass[polish]{standalone}
\usepackage{thesis}

\begin{document}
\pagestyle{headings}

\chapter{Teoria}

\section{Wprowadzenie}

Przez \textit{grę} rozumiemy matematyczny opis pewnej sytuacji konfliktowej, w której biorą udział określone strony,
nazywane \textit{graczami}. Każdej stronie przypisujemy pewien zbiór \textit{strategii}, z których w danym momencie
wykorzystuje jedną. Każdemu z graczy przypisujemy również \textit{funkcję wypłaty}, której wartość uzależniona jest
od wszystkich strategii granych przez graczy w określonej chwili.

W zależności od rozpatrywanego rodzaju gry formalna definicja wymienionych pojęć jest nieco inna. W tej pracy rozważane
będą 2 rodzaje gier: \textit{gry w postaci strategicznej} oraz \textit{gry w postaci ekstensywnej}. Dla obu z nich
możliwe jest zdefiniowanie tzw. \textit{równowagi Nasha} tj. takiej kombinacji wyborów strategii przez graczy, aby dla
każdego z nich nieopłacalne było odstąpienie od obecnie granej strategii.

Szczególną uwagę poświęcono grom dla których możliwe jest obliczenie równowagi Nasha przy pomocy programowania 
liniowego/całkowitoliczbowego lub rekurencyjnego przeszukania danych.

\section{Gra w postaci strategicznej}

\begin{definition}
\textbf{Grą w postaci strategicznej (normalnej)} nazywamy trójkę:
\begin{enumerate}
\item skończony zbiór graczy $I = 1, 2, 3, ..., n$,
\item przestrzeń strategii czystych gracza $S_i$ zdefiniowaną dla każdego gracza $i \in I$,
\item funkcję wypłaty $u_i(s)$ określającą wypłatę gracza $i \in I$ dla każdego profilu $s \in S$.
\end{enumerate}
\cite[str.~4]{FT-GT}
\end{definition}

Przy tak zdefiniowanej grze zakładamy, że każdy z graczy decyduje się na jedną ze swoich strategii, a następnie
na podstawie wyborów podjętych przez wszystkich graczy przypisujemy każdemu z nich wypłatę.

Możemy przyjąć, że dla tak przyjętych oznaczeń $s_i$ oznacza wybór $i$-tego gracza dla profilu $s$, zaś $s_{-i}$ profil
wszystkich wyborów oprócz wyboru gracza $i$. Analogicznie $S_{-i}$ oznacza zbiór wszystkich możliwych odpowiedzi
na granie strategii $s_i$ przez gracza $i$.

\begin{definition}
\textbf{Strategią mieszaną} gracza $i$ nazywamy rozkład $\sigma_i$ nad strategiami czystymi $S_i$. Wówczas funkcja
wypłaty ma postać $u_i(\sigma_i, \sigma^{*})$ i jest wartością oczekiwaną funkcji wypłaty dla strategii mieszanych
wszystkich graczy.
\cite[str.~5]{FT-GT}
\end{definition}

\subsection{Równowagi w strategiach czystych}

\begin{definition}
\textbf{Równowagą Nasha w strategiach czystych} w grze w postaci strategicznej nazywamy profil strategii $s \in S$ taki,
że:
$$\forall_{i \in I} \forall_{s_{-i} \in S_{-i}} u_i(s) \geq u_i(s_i, s_{-i})$$
\cite[str.~11]{FT-GT}
\end{definition}

Oznacza to, że równowagą jest profil strategii, dla którego pojedyncza zmiana granej strategii nie jest w stanie 
poprawić wypłaty żadnego z graczy.

Równowaga taka nie zawsze istnieje, czego przykładem jest gra w papier-kamień-nożyce:

\begin{tabular}[t]{| c | c | c | c |}
\hline
$p_1 \downarrow$, $p_2 \rightarrow$  & papier & kamień & nożyce \\
\hline
papier                               & 0,0    & 1,-1   & -1,1   \\
\hline
kamień                               & -1,1   & 0,0    & 1,-1   \\
\hline
nożyce                               & 1,-1   & -1,1   & 0,0    \\
\hline
\end{tabular}

W takiej sytuacji każdy z graczy zawsze może zmienić swoją strategię na taką, w której jego wypłata zostanie zwiększona.

Problem szukania równowagi w strategiach czystych nie ma wydajnego rozwiązania \cite[str.~16]{FT-GT}. Wszystko co
możemy zrobić to zoptymalizować metodę \textit{brute force}, poprzez eliminację strategii zdominowanych
\cite[str.~9--11]{FT-GT}.

\begin{definition}
\textbf{Strategia zdominowana} to taka strategia $s_i \in S_i$, że:
$$\exists_{s'_i} \forall_{s_{-1} \in S} u_i(s_i, s_{-i}) \leq u_i(s'_i, s_{-i})$$
\cite[str.~6--7]{FT-GT}
\end{definition}

Strategia taka zawsze może zostać zastąpiona przez jakąś inną strategię, więc szukając punktu równowagi Nasha możemy ją
pominąć w rozważaniach - z definicji nie może ona wchodzić w skład szukanego profilu.

\textbf{Metoda eliminacji strategii zdominowanych} wykorzystuje ten fakt do usuwania ich z rozważanej gry tak długo, aż
zostaną wyłącznie strategie niezdominowane. Zdarza się, że prowadzi to do sytuacji gdzie równowaga jest oczywista, ale
często konieczne jest jednak przeszukiwanie pozostałej przestrzeni rozwiązań aż do jej znalezienia lub stwierdzenia jej
braku.

\subsection{Równowagi w strategiach mieszanych}

\begin{theorem}
\textbf{Twierdzenie Nasha o istnieniu równowagi} - każda skończona gra $(I, S_i, u_i)$ ma równowagę w strategiach
mieszanych.
\cite[str.~29]{FT-GT}
\end{theorem}

Dowodzone jest to przy pomocy \textbf{twierdzenia o punkcie stałym Kakutaniego} \cite[str.~29]{FT-GT}.

Gwarantuje nam to możliwość znalezienia równowagi (w strategiach mieszanych) w każdej grze skończonej, nie mówi nam
jednak jak je znaleźć.

\subsubsection{Równowagi w strategiach mieszanych w grach jednomacierzowych}

\begin{definition}
\textbf{Gra o sumie zerowej} to taka gra, że:
$$\forall_{s \in S} \sum_{i \in I} u_i(s) = 0$$
\end{definition}

Gdy w grze bierze udział 2 graczy wartości ich wypłat będą dokładnie przeciwne, można więc funkcję wypłaty zapisać przy
pomocy macierzy $A_{ij}$, gdzie $i$ oznacza wybór strategii pierwszego gracza, a $j$ wybór gracza drugiego. Wartość
stanowi wypłatę pierwszego z graczy.

W takiej sytuacji pierwszy z graczy będzie dążył do maksymalizacji wypłaty, zaś gracz drugi do jej minimalizacji:

$$\max_{\sigma_1} \{ \min_{j \in J} u_1(\sigma_1, j) \}$$
$$\min_{\sigma_2} \{ \max_{i \in I} u_2(i, \sigma_2) \}$$

Tak zdefiniowany problem po pewnych modyfikacjach możemy przekształcić do programowania liniowego:

$$\max_{\sigma_1} \{ \min_{j \in J} \sum_{i \in I} A_{ij} \sigma_1(i) \}$$
$$\sum_{i \in I} \sigma_1(i) = 1$$
$$\forall_{i \in I} \sigma_1(i) \geq 0$$

$$\downarrow$$

$$\max_{\sigma_1,v} v$$
$$\forall_{j \in J} \sum_{i \in I} A_{ij} \sigma_1(i) \geq v$$
$$\sum_{i \in I} \sigma_1(i) = 1$$
$$\forall_{i \in I} \sigma_1(i) \geq 0$$

$$\downarrow$$
podstawiając $$x_i = \frac{\sigma_1(i)}{v}$$
$$\downarrow$$

$$\max_{\sigma_1,v} v$$
$$\forall_{j \in J} \sum_{i \in I} A_{ij} \sigma_1(i) \geq 1$$
$$\sum_{i \in I} \sigma_1(i) = \frac{1}{v}$$
$$\forall_{i \in I} \sigma_1(i) \geq 0$$

$$\downarrow$$

$$\min_x \sum_{i \in I} x_i$$
$$A^Tx \geq 1$$
$$x \geq 0$$

Przeprowadzając analogiczne rozumowanie dla gracza drugiego otrzymamy:

$$\max_y \sum_{j \in J} y_i$$
$$Ay \leq 1$$
$$y \geq 0$$

Okazuje się więc, że są to problemy dualne - odpowiednia implementacja algorytmu simpleks jest w stanie otrzymać oba
rozwiązania przy jednym uruchomieniu procedury. Należy jedynie pamiętać aby otrzymane wartości pomnożyć przez wartość
funkcji celu, aby wrócić do ich oryginalnej postaci.

\subsubsection{Równowagi w strategiach mieszanych w grach dwumacierzowych}

Dla gier dwumacierzowych (gier o sumie dowolnej) sytuacja się komplikuje. Istnieje kilka opisanych algorytmów, które
pozwalają na znalezienie równowagi Nasha. Wśród najczęściej wymienianych są to:
\begin{itemize}
\item algorytm \textbf{Lemke-Howsona} - wykorzystujący podprocedury algorytmu simplex,
\item algorytm \textbf{Porter-Nudelman-Shoham (PNS)} - korzysta z programowanie liniowego (wersja dla liczby graczy
$n > 2$ jest nieliniowa) \cite{PNS-NE},
\item algorytm \textbf{Sandholm-Gilpin-Conitzer} - wykorzystuje programowanie całkowitoliczbowe \cite{SCG-NE}.
\end{itemize}

Spośród wyżej wymienionych zdecydowano się na przetestowanie działania trzeciego rozwiązania. Jest ono relatywnie nowe,
a więc nie posiada wielu praktycznych implementacji - stworzenie i udostępnienie takowej może być istotniejszym wkładem
badawczym niż tworzenie kolejnej wersji powszechnie stosowanego algorytmu.

Algorytm \textbf{Sandholm-Gilpin-Conitzer} w podstawowej wersji definiuje kilka ograniczeń, dbających o to, aby 
otrzymane wartości zawsze stanowiły poprawne rozwiązanie (równowagę Nasha) - nie definiuje on jednak funkcji celu,
pozwalając jego użytkownikom na samodzielne ich zdefiniowanie. Każda liniowa funkcja celu może zostać wykorzystana.

Wykorzystane są: 
\begin{itemize}
\item zmienna $p_{s_i}$ - prawdopodobieństwo grania strategii $s_i$,
\item zmienna pomocnicza $U_i$. Dla gracza $i$ zmienna ta oznacza różnicę między maksymalnym i minimalnym zyskiem jaki
może on osiągnąć:
$$U_i = \max_{s_i^h, s_i^l \in S_i, s_{1-i}^h, s_{1-i}^l \in S_{1-i}} u_i(s_i^h, s_{1-i}^h) - u_i(s_i^l, s_{1-i}^l)$$
\item zmienna $u_{s_i}$ - oznacza ono oczekiwaną wypłatę gracza grającego $s_i$ dla obecnej strategii mieszanej drugiego
gracza,
\item zmienną $r_{s_i}$ - ,,żal''. Wartość określającą różnicę między maksymalnym oczekiwanym zyskiem dla pewnej
strategii czystej, a wartością oczekiwaną dla $s_i$,
\item zmienna binarna $b_{s_i}$ - dla wartości równej $1$, prawdopodobieństwo użycia strategii $s_i$ jest zerowe,
dla $0$, może ona się pojawić o ile żal wyniesie $0$.
\end{itemize}

Wówczas ograniczenia możemy zdefiniować następująco $\forall_{i \in I}$:
\begin{enumerate}
\item $$\sum_{{s_i} \in S_i} p_{s_i} = 1$$
\item $$\forall_{s_i \in S_i} u_{s_i} = \sum_{s_{1-i} \in S_{1-i}} p_{s_{1-i}} u_i(s_i, s_{1-i})$$
\item $$\forall_{s_i \in S_i} u_i \geq u_{s_i}$$
\item $$\forall_{s_i \in S_i} r_{s_i} = u_i - u_{s_i}$$
\item $$\forall_{s_i \in S_i} p_{s_i} \leq 1-b_{s_i}$$
\item $$\forall_{s_i \in S_i} r_{s_i} \leq U_i b_{s_i}$$
\end{enumerate}

Tak po dodaniu do tak zdefiniowanego problemu całokowitoliczbowego funkcji celu, każde osiągalne rozwiązanie będzie
stanowić poprawne rozwiązanie. \cite[str.~2]{SCG-NE}

Autorzy dalej omawiają dalej 3 kolejne specjalizacje tego problemu, aby osiągnąć kolejno:
\begin{enumerate}
\item wprowadzać karę za żal, oraz dążyć do jego minimalizacji - ograniczenia $1$, $2$, $3$, $4$, $5$ oraz:
$$\textbf{minimalizuj} \sum_{i \in \{0,1\}} \sum_{s_i \in S_i} f_{s_i} - U_i b_{s_i}$$
$$\forall_{i \in I} \forall_{s_i \in S_i} f_{s_i} \geq r_{s_i}$$
$$\forall_{i \in I} \forall_{s_i \in S_i} f_{s_i} \geq U_i b_{s_i}$$
\cite[str.~2]{SCG-NE}
\item wprowadzić karę za prawdopodobieństwo wykorzystania strategii z niezerowym żalem - ograniczenia $1$, $2$, $3$,
$4$, $6$ oraz:
$$\textbf{minimalizuj} \sum_{i \in \{0,1\}} \sum_{s_i \in S_i} g_{s_i} - (1 - b_{s_i})$$
$$\forall_{i \in I} \forall_{s_i \in S_i} g_{s_i} \geq p_{s_i}$$
$$\forall_{i \in I} \forall_{s_i \in S_i} g_{s_i} \geq 1 - b_{s_i}$$
\cite[str.~2]{SCG-NE}
\item karać zarówno żal jak i prawdopodobieństwo strategii z niezerowym żalem - ograniczenia $1$, $2$, $3$, $4$ oraz:
$$\textbf{minimalizuj} \sum_{i \in \{0,1\}} \sum_{s_i \in S_i} f_{s_i} + g_{s_i}$$
$$\forall_{i \in I} \forall_{s_i \in S_i} f_{s_i} \geq \frac{r_{s_i}}{U_i}$$
$$\forall_{i \in I} \forall_{s_i \in S_i} f_{s_i} \geq b_{s_i}$$
$$\forall_{i \in I} \forall_{s_i \in S_i} g_{s_i} \geq p_{s_i}$$
$$\forall_{i \in I} \forall_{s_i \in S_i} g_{s_i} \geq 1 - b_{s_i}$$
\cite[str.~2--3]{SCG-NE}
\end{enumerate}

\subsubsection{Gry o większej liczbie graczy}

Dla gier o większej liczbie graczy istnieją odpowiednie algorytmy do szukania równowagi Nasha. Jednym z częściej
wymienianych jest algorytm \textbf{Herberta Scarfa} \cite{SCARF-NR}.

TODO

Inną możliwością jest zastosowanie algorytmu \textbf{Porter-Nudelman-Shoham (PNS)} dla $n > 2$ graczy. \cite{PNS-NE}

TODO

Z braku czasu nie udało się jednak wdrożyć żadnego z tych algorytmów do ostatecznej wersji projektu. Implementacja
została więc tak zaplanowana, aby możliwe było wdrożenie wybranego z wyżej wymienionych algorytmów w przyszłości.

\section{Gra w postaci ekstensywnej}

\begin{definition}
\textbf{Grą w postaci ekstensywnej} nazywamy szóstkę:
\begin{enumerate}
\item zbiór graczy,
\item porządek ruchów,
\item funkcję wypłaty gracza od ciągu poczynionych ruchów,
\item wybory graczy dostępne w danym ruchu,
\item wiedza gracza w chwili podejmowania decyzji,
\item rozkład prawdopodobieństwa nad zdarzeniami zewnętrznymi (\textit{naturą}).
\end{enumerate}
\cite[str.~77--78]{FT-GT}
\end{definition}

Taką grę można przedstawić jako drzewo, którego liście zawierają wypłaty, krawędzie odpowiadają określonym decyzjom,
a węzły chwile ich podejmowania przez określonego gracza. 

\begin{definition}
\textbf{Doskonała równowaga Nasha w podgrach} - jest to taka równowaga Nasha, że dla każdej podgry dalej gry jest ona
poprawnym rozwiązaniem.
\end{definition}

\begin{theorem}
Każda skończona gra w postaci ekstensywnej ma doskonałą równowagę Nasha w podgrach.
\end{theorem}

\subsection{Równowagi w strategiach czystych w grach z informacją doskonałą i zupełną}

\begin{definition}
\textbf{Gra z informacją doskonałą} to gra, w której każdy z graczy w dowolnym momencie jest poinformowany o wszystkich
wiodących do danej chwili ruchach.
\end{definition}

Dla przypadku gry w postaci ekstensywnej oznacza to, że możemy ją poprawnie sprowadzić do postaci, gdzie każdy węzeł
znajduje się w jednoelementowym zbiorze informacyjnym. Z kolei taka gra posiada interesującą właściwość - wiedząc gdzie
dokładnie znajdujemy się w drzewie gry zawsze możemy wybrać optymalną strategię, jeśli tylko wiemy jakie wypłaty
ostatecznie otrzymalibyśmy dla każdej z możliwości. Ponieważ mamy do czynienia z graczami racjonalnymi możemy spodziewać
się, że również oni wybraliby optymalne dla siebie strategie.

Dysponując kompletną informacją możemy schodzić w głąb drzewa gry, aby ostatecznie dojść do liści zawierających wypłaty.
Na tym poziomie bieżący gracz posiada już wszystkie informacje potrzebne do podjęcia najkorzystniejszej dla siebie
decyzji. Gracz rozgrywający w poprzedzającym kroku jest z kolei w stanie ją przewidzieć. W ten sposób wychodząc od liści
i przesuwając się ,,w górę'' drzewa gry dochodzimy w końcu do punktu wyjściowego - w tym momencie znamy już wszystkie
decyzje jakie podjęliby gracze, a tym samym ich wypłaty. Jest to optymalna wartość wypłaty dla każdego z nich i żaden
nie chciałby od niej odstąpić - tym samym odnaleźlibyśmy w ten sposób równowagę Nasha w tej grze.

Algorytm ten opiera się na spostrzeżeniu, że do podjęcia decyzji konieczna jest znajomość rozwiązania w każdym poddrzewie
gry i dla każdego poddrzewa również jest to rozwiązanie poprawne. Odnajduje więc on doskonałą równowagę Nasha w podgrach
gier z informacją doskonałą.

\subsection{Inne gry w postaci ekstensywnej}

W grach bez informacji doskonalej sytuacja komplikuje się. Z zbiorze informacyjnym może znajdować się kilka węzłów -
wówczas nie wiemy dokładnie w którym z nich się znajdujemy, zaś dla każdego z nich inny wybór strategii może być tym
optymalnym. Proste przejrzenie drzewa od liści do korzenia nie pozwoli nam w oczywisty sposób wybrać najlepszych
strategii.

W takiej sytuacji można jednak znaleźć równowagę Nasha w \textbf{strategiach mieszanych} lub \textbf{behawioralnych}.

\begin{definition}
\textbf{Strategie mieszane} definiuje się analogicznie jak w grach w postaci strategicznej - istotny jest jednak fakt,
że strategią czystą jest zdefiniowana decyzja we wszystkich wierzchołkach drzewa, w których ruch należy do danego gracza
i to nad takimi kompletnymi decyzjami jest ustanawiany rozkład.
\end{definition}

Tymczasem
\begin{definition}
\textbf{strategie behawioralne} określają rozkład nad wyborem w określonym wierzchołku.
\end{definition}

Ponownie ograniczenia czasowe spowodowały, że jedynie najprostszy do rozpatrzenia przypadek wszedł w skład implementacji
projektu, zaś poszukiwanie równowag w strategiach mieszanych i behawioralnych przeznaczono do zaimplementowania
w przyszłości.

\end{document}
